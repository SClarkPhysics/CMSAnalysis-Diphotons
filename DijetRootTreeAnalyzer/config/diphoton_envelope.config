[diphoton_envelope]
variables = ['mjj[303., 303., 3110.]','th1x[0, 0, 114]','pdf_index_diphoton_envelope[dijet=0,moddijet=1,atlas=2,dipho=3,power=4]']

histoName = 'data_XM1'

variables_range = ['mjj_Low[303., 3110.]', 'mjj_Blind[303., 3110.]', 'mjj_High[303., 3110.]']

#for 3-par bkg fit
combine_parameters = [
            'Ntot_diphoton_dijet_bkg[ 1400. ]',
            'Ntot_diphoton_moddijet_bkg[ 1400. ]',
            'Ntot_diphoton_atlas_bkg[ 1400. ]',
					  'Ntot_diphoton_dipho_bkg[ 1400. ]',
            'Ntot_diphoton_power_bkg[ 1400. ]',
					  'Ntot_multi_diphoton_envelope[ 1400. ]',

            'p0_diphoton_dijet[ 1.]',
            'p1_diphoton_dijet[80.]',
            'p2_diphoton_dijet[-10.]',
            'p3_diphoton_dijet[-1.]',
            'p4_diphoton_dijet[-1.]',
            'diphoton_dijet_bkg_norm[1]',
            'meff_diphoton_dijet[-1]',
            'seff_diphoton_dijet[-1]',

            'p0_diphoton_moddijet[ 1.]',
            'p1_diphoton_moddijet[80.]',
            'p2_diphoton_moddijet[-10.]',
            'p3_diphoton_moddijet[-1.]',
            'p4_diphoton_moddijet[-1.]',
            'diphoton_moddijet_bkg_norm[1]',
            'meff_diphoton_moddijet[-1]',
            'seff_diphoton_moddijet[-1]',

            'p0_diphoton_atlas[1.]',
            'p1_diphoton_atlas[1.]',
            'p2_diphoton_atlas[100.]',
            'p3_diphoton_atlas[-500.]',
            'pm4_diphoton_atlas[0]',
            'diphoton_atlas_bkg_norm[1]',
            'meff_diphoton_atlas[-1]',
            'seff_diphoton_atlas[-1]',

            'p0_diphoton_dipho[0.1]',
            'p1_diphoton_dipho[-10.]',
            'p2_diphoton_dipho[10.]',
            'p3_diphoton_dipho[-1.]',
            'pm4_diphoton_dipho[0]',
            'diphoton_dipho_bkg_norm[1]',
            'meff_diphoton_dipho[-1]',
            'seff_diphoton_dipho[-1]',

            'p0_diphoton_power[ 1.]',
            'p1_diphoton_power[-10]',
            'p2_diphoton_power[-1000.]',
            'p3_diphoton_power[10.]',
            'p4_diphoton_power[-0.1]',
            'diphoton_power_bkg_norm[1]',
            'meff_diphoton_power[-1]',
            'seff_diphoton_power[-1]',

            #
					  'p0_diphoton_envelope[1.]',
					  'p1_diphoton_envelope[-1.0]', 
					  'p2_diphoton_envelope[-1.0]',
					  'p3_diphoton_envelope[0]',
					  'p4_diphoton_envelope[0]',
		        'diphoton_envelope_bkg_norm[1]',
	      	  'meff_diphoton_envelope[-1]',
					  'seff_diphoton_envelope[-1]',
            #

					  'sqrts_dijet[13000]',	     
            'sqrts_moddijet[13000]',
					  'sqrts_atlas[13000]',
					  'sqrts_dipho[13000]',
					  'sqrts_power[13000]',
					  'sqrts[13000]',	     
            ]
		      
combine_pdfs = [
        'RooDijet5ParamBinPdf::diphoton_dijet_bkg(th1x,p1_diphoton_dijet,p2_diphoton_dijet,p3_diphoton_dijet,p4_diphoton_dijet,sqrts_dijet)',
        "EXPR::diphoton_dijet_bkg_unbin('p0_diphoton_dijet*(pow(1-mjj/sqrts_dijet,p1_diphoton_dijet)/pow(mjj/sqrts_dijet,p2_diphoton_dijet+p3_diphoton_dijet*log(mjj/sqrts_dijet)+p4_diphoton_dijet*log(mjj/sqrts_dijet)*log(mjj/sqrts_dijet)))',mjj,p0_diphoton_dijet,p1_diphoton_dijet,p2_diphoton_dijet,p3_diphoton_dijet,p4_diphoton_dijet,sqrts_dijet)",

        'RooModDijet5ParamBinPdf::diphoton_moddijet_bkg(th1x,p1_diphoton_moddijet,p2_diphoton_moddijet,p3_diphoton_moddijet,p4_diphoton_moddijet,sqrts_moddijet)',
        "EXPR::diphoton_moddijet_bkg_unbin('p0_diphoton_moddijet*( pow(1-pow((mjj/sqrts_moddijet),1.0/3.0), p1_diphoton_moddijet)/pow((mjj/sqrts_moddijet), p2_diphoton_moddijet + p3_diphoton_moddijet*log((mjj/sqrts_moddijet)) +p4_diphoton_moddijet*log((mjj/sqrts_moddijet))*log((mjj/sqrts_moddijet))) )',mjj,p0_diphoton_moddijet,p1_diphoton_moddijet,p2_diphoton_moddijet,p3_diphoton_moddijet,p4_diphoton_moddijet,sqrts_moddijet)",

        'RooAtlas5ParamBinPdf::diphoton_atlas_bkg(th1x,p1_diphoton_atlas,p2_diphoton_atlas,p3_diphoton_atlas,pm4_diphoton_atlas,sqrts_atlas)',
        "EXPR::diphoton_atlas_bkg_unbin('p0_diphoton_atlas/(pow(mjj/sqrts_atlas,p1_diphoton_atlas))*exp(-((p2_diphoton_atlas*(mjj/sqrts_atlas))+(p3_diphoton_atlas*pow(mjj/sqrts_atlas,2))+(pm4_diphoton_atlas*pow(mjj/sqrts_atlas,3))))',mjj,p0_diphoton_atlas,p1_diphoton_atlas,p2_diphoton_atlas,p3_diphoton_atlas,pm4_diphoton_atlas,sqrts_atlas)",

        'RooDiphoFuncBinPdf::diphoton_dipho_bkg(th1x,p1_diphoton_dipho,p2_diphoton_dipho,p3_diphoton_dipho,pm4_diphoton_dipho,sqrts_dipho)',
        "EXPR::diphoton_dipho_bkg_unbin('p0_diphoton_dipho*pow(mjj/sqrts_dipho, p1_diphoton_dipho + p2_diphoton_dipho*log(mjj/sqrts_dipho) + p3_diphoton_dipho*log(mjj/sqrts_dipho)*log(mjj/sqrts_dipho) + pm4_diphoton_dipho*log(mjj/sqrts_dipho)*log(mjj/sqrts_dipho)*log(mjj/sqrts_dipho))',mjj,p0_diphoton_dipho,p1_diphoton_dipho,p2_diphoton_dipho,p3_diphoton_dipho,pm4_diphoton_dipho,sqrts_dipho)",

        'RooPowerBinPdf::diphoton_power_bkg(th1x,p1_diphoton_power,p2_diphoton_power,p3_diphoton_power,p4_diphoton_power,sqrts_power)',
        "EXPR::diphoton_power_bkg_unbin('p0_diphoton_power * (pow(p2_diphoton_power + p3_diphoton_power*(mjj/sqrts_power) + p4_diphoton_power*(mjj/sqrts_power)*(mjj/sqrts_power), p1_diphoton_power))',mjj,p0_diphoton_power,p1_diphoton_power,p2_diphoton_power,p3_diphoton_power,p4_diphoton_power,sqrts_power)",

         'RooMultiPdf::DIPHO_multi(pdf_index_diphoton_envelope,diphoton_dijet_bkg,diphoton_moddijet_bkg,diphoton_atlas_bkg,diphoton_dipho_bkg,diphoton_power_bkg)',
		     'SUM::extDijetPdf(Ntot_multi_diphoton_envelope*DIPHO_multi)'
				]

signal_mjj = [303.0, 310.0, 317.0, 324.0, 331.0, 338.0, 345.0, 352.0, 360.0, 368.0, 376.0, 384.0, 392.0, 400.0, 409.0, 418.0, 427.0, 436.0, 445.0, 454.0, 464.0, 474.0, 484.0, 494.0, 504.0, 515.0, 526.0, 537.0, 548.0, 560.0, 572.0, 584.0, 596.0, 609.0, 622.0, 635.0, 648.0, 662.0, 676.0, 690.0, 704.0, 719.0, 734.0, 749.0, 765.0, 781.0, 797.0, 814.0, 831.0, 848.0, 866.0, 884.0, 902.0, 921.0, 940.0, 959.0, 979.0, 999.0, 1020.0, 1041.0, 1063.0, 1085.0, 1107.0, 1130.0, 1153.0, 1177.0, 1201.0, 1226.0, 1251.0, 1277.0, 1303.0, 1330.0, 1357.0, 1385.0, 1413.0, 1442.0, 1472.0, 1502.0, 1533.0, 1564.0, 1596.0, 1629.0, 1662.0, 1696.0, 1731.0, 1766.0, 1802.0, 1839.0, 1877.0, 1915.0, 1954.0, 1994.0, 2035.0, 2077.0, 2119.0, 2162.0, 2206.0, 2251.0, 2297.0, 2344.0, 2392.0, 2441.0, 2491.0, 2542.0, 2594.0, 2647.0, 2701.0, 2756.0, 2812.0, 2869.0, 2927.0, 2987.0, 3048.0, 3110.0]
signal_th1x = range(0,114+1)



